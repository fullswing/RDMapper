from rdmapper.rdmapper import mapped_smarts_by_imap, initialize_smarts, add

class TestClass:

    def test_initialize_smarts(self):
        trg = "[#9]-[#6]1(-[#9])-[#6]-[#6]-[#6]-[#6]-[#6]-1>>[#8]=[#6]1-[#6]-[#6]-[#6]-[#6]-[#6]-1"
        ans = "[#9:1]-[#6:2]1(-[#9:3])-[#6:4]-[#6:5]-[#6:6]-[#6:7]-[#6:8]-1>>[#8:9]=[#6:10]1-[#6:11]-[#6:12]-[#6:13]-[#6:14]-[#6:15]-1"
        res = initialize_smarts(trg)
        assert ans == res
        trg = "[#9]-[#6]1(-[#9])-[#6]-[#6]-[#6]-[#6]-[#6]-1"
        ans = "[#9:1]-[#6:2]1(-[#9:3])-[#6:4]-[#6:5]-[#6:6]-[#6:7]-[#6:8]-1"
        res = initialize_smarts(trg)
        assert ans == res
        trg = "[#6]-[#8]>>[#6]-[#8]-[Si](-[#6])(-[#6](-[#6])(-[#6])-[#6])-[#6]"
        ans = "[#6:1]-[#8:2]>>[#6:3]-[#8:4]-[Si:5](-[#6:6])(-[#6:7](-[#6:8])(-[#6:9])-[#6:10])-[#6:11]"
        res = initialize_smarts(trg)
        assert res == ans

    def test_mapped_smarts_by_imap(self):
        trg = "[#9:1]-[#6:2]1(-[#9:3])-[#6:4]-[#6:5]-[#6:6]-[#6:7]-[#6:8]-1>>[#8:9]=[#6:10]1-[#6:11]-[#6:12]-[#6:13]-[#6:14]-[#6:15]-1"
        idx_map = {10:2, 11:4, 12:5, 13:6, 14:7, 15:8}
        ans = "[#9:1]-[#6:2]1(-[#9:3])-[#6:4]-[#6:5]-[#6:6]-[#6:7]-[#6:8]-1>>[#8]=[#6:2]1-[#6:4]-[#6:5]-[#6:6]-[#6:7]-[#6:8]-1"
        res = mapped_smarts_by_imap(trg, idx_map)
        assert res == ans
        trg = "[#6:1]-[#8:2]>>[#6:3]-[#8:4]-[Si:5](-[#6:6])(-[#6:7](-[#6:8])(-[#6:9])-[#6:10])-[#6:11]"
        idx_map = {4:2, 3:1}
        ans = "[#6:1]-[#8:2]>>[#6:1]-[#8:2]-[Si](-[#6])(-[#6](-[#6])(-[#6])-[#6])-[#6]"
        res = mapped_smarts_by_imap(trg, idx_map)
        assert res == ans
        trg="[#8:1]=[#6:2]1-[#6:3]-[#6:4]-[#6:5]-[#6:6]-[#6:7]-1-[#6:8]1-[#6:9]-[#6:10]-[#6:11]-[#6:12]-[#6:13]-1>>[#8:14]=[#6:15]1-[#6:16]-[#6:17]-[#6:18]-[#6:19]-[#6:20]-1.[#6:21]-[#16:22](-[#8:23]-[#6:24]1-[#6:25]-[#6:26]-[#6:27]-[#6:28]-[#6:29]-1)(=[#8:30])=[#8:31]"
        idx_map = {14:1, 20:7, 19:6, 18:5, 17:4, 16:3, 15:2, 24:8, 29:9, 28:10, 27:11, 26:12, 25:13}
        ans = "[#8:1]=[#6:2]1-[#6:3]-[#6:4]-[#6:5]-[#6:6]-[#6:7]-1-[#6:8]1-[#6:9]-[#6:10]-[#6:11]-[#6:12]-[#6:13]-1>>[#8:1]=[#6:2]1-[#6:3]-[#6:4]-[#6:5]-[#6:6]-[#6:7]-1.[#6]-[#16](-[#8]-[#6:8]1-[#6:13]-[#6:12]-[#6:11]-[#6:10]-[#6:9]-1)(=[#8])=[#8]"
        res = mapped_smarts_by_imap(trg, idx_map)
        assert res == ans

    def test_add(self):
        ans = 6
        assert add(2, 2) == ans
